import pefile
import sys

class Extract_Imports:
    def __init__(self, file_path):
        self.file = file_path

    #this will also extract imported functions
    def extract_imports(self):
        pe = pefile.PE(self.file)

        if hasattr(pe, 'DIRECTORY_ENTRY_IMPORT'):
            for entry in pe.DIRECTORY_ENTRY_IMPORT:
                print(f"Imported DLL: {entry.dll.decode('utf-8')}")
                for imports in entry.imports:
                    print(f"Function: {imports.name.decode('utf-8')}")
    
    #Maybe need to add entry export (see page 50)